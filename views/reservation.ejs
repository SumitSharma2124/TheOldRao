<section class="container reservation-page">
  <h2 class="res-title">Reserve a Table</h2>

  <div class="reservation-grid">
    <!-- Reservation Form -->
    <form action="/reservation" method="POST" class="reservation-form" autocomplete="on">
      <div class="field">
        <label for="resName">Full name</label>
        <input id="resName" type="text" name="name" placeholder="Your Name" required>
      </div>

      <div class="field">
        <label for="resPhone">Phone</label>
        <input id="resPhone" type="tel" name="phone" placeholder="Phone Number" required pattern="[0-9]{10}" inputmode="numeric">
        <small class="hint">10-digit number</small>
      </div>

      <div class="field">
        <label for="resGuests">Guests</label>
        <div class="stepper">
          <button class="step-btn" type="button" data-step="-1" aria-label="Decrease guests">−</button>
          <input id="resGuests" type="number" name="guests" placeholder="Guests" required min="1" value="2">
          <button class="step-btn" type="button" data-step="1" aria-label="Increase guests">+</button>
        </div>
      </div>

      <div class="grid-2">
        <div class="field">
          <label for="resDate">Date</label>
          <input id="resDate" type="date" name="date" required>
        </div>
        <div class="field">
          <label for="resTime">Time</label>
          <input id="resTime" type="time" name="time" required>
        </div>
      </div>

      <div class="field">
        <label for="resMsg">Special requests</label>
        <textarea id="resMsg" name="message" placeholder="Allergies, seating preference, celebration details (optional)"></textarea>
      </div>

      <button type="submit" class="btn-primary">Book Table</button>
    </form>

    <!-- Info Card -->
    <aside class="info-card">
      <h3>Dining Hours</h3>
      <ul class="bullets">
        <li>Lunch: 11:30 AM – 3:30 PM</li>
        <li>Dinner: 6:30 PM – 10:30 PM</li>
      </ul>
      <h3>Quick Tips</h3>
      <ul class="bullets">
        <li>We hold tables for 15 minutes past the reservation time.</li>
        <li>For groups 8+, please call us for arrangements.</li>
        <li>Let us know about allergies in the notes.</li>
      </ul>
      <div class="callout">
        Prefer a call? <a href="tel:+919999999999">+91 99999 99999</a>
      </div>
    </aside>
  </div>

  <style>
    .res-title { font-family: 'Playfair Display', serif; margin: 0 0 12px; }
    .reservation-grid { display:grid; grid-template-columns: 1.1fr .9fr; gap: 18px; align-items:start; }
    .reservation-form { display:grid; grid-template-columns: 1fr; gap: 12px; background:#fff; border:1px solid #eee; border-radius:14px; padding:16px; box-shadow: var(--card-shadow); }
    .reservation-form .grid-2 { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .reservation-form .field { display:flex; flex-direction:column; gap:6px; }
    .reservation-form label { font-size:.9rem; opacity:.8; }
    .reservation-form input, .reservation-form textarea { padding: 10px 12px; border:1px solid #ddd; border-radius:10px; }
    .hint { font-size: .8rem; opacity:.7; margin-top:-4px; }
    .stepper { display:flex; align-items:center; gap:6px; }
    .step-btn { width:36px; height:36px; border-radius:10px; border:1px solid #ddd; background:#fafafa; cursor:pointer; font-size:18px; line-height:1; }
    .info-card { background:#fff; border:1px solid #eee; border-radius:14px; padding:16px; box-shadow: var(--card-shadow); }
    .info-card h3 { margin: 6px 0 8px; font-size: 1.05rem; }
    .bullets { margin:0 0 10px; padding-left: 16px; }
    .callout { margin-top: 10px; background:#fff8e1; border:1px solid #ffe4a6; padding:10px; border-radius:10px; }
    @media (max-width: 820px){ .reservation-grid { grid-template-columns: 1fr; } .reservation-form .grid-2 { grid-template-columns: 1fr; } }
    /* bottom space */
    section.container.reservation-page { margin-bottom: 24px; }
  </style>

  <script>
    (function(){
      const guests = document.getElementById('resGuests');
      document.querySelectorAll('.step-btn').forEach(b => {
        b.addEventListener('click', ()=>{
          const step = Number(b.dataset.step||1);
          let v = Number(guests.value||1) + step;
          if (isNaN(v)) v = 1;
          v = Math.max(1, Math.min(20, v));
          guests.value = v;
        });
      });

      // Date/time helpers
      const d = document.getElementById('resDate');
      const t = document.getElementById('resTime');
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth()+1).padStart(2,'0');
      const dd = String(today.getDate()).padStart(2,'0');
      d.min = `${yyyy}-${mm}-${dd}`;
      // dining window defaults
      const openLunch = '11:30';
      const closeDinner = '22:30';
      t.min = openLunch; t.max = closeDinner;

      function clampIfToday(){
        const sel = new Date(d.value);
        const now = new Date();
        if (!isNaN(sel.getTime())){
          const sameDay = sel.getFullYear()===now.getFullYear() && sel.getMonth()===now.getMonth() && sel.getDate()===now.getDate();
          if (sameDay){
            const hh = String(now.getHours()).padStart(2,'0');
            const mi = String(now.getMinutes()).padStart(2,'0');
            const cur = `${hh}:${mi}`;
            t.min = cur > openLunch ? cur : openLunch;
            if (t.value && t.value < t.min) t.value = t.min;
          } else {
            t.min = openLunch;
          }
        }
      }
      d.addEventListener('change', clampIfToday);
      clampIfToday();
    })();
  </script>

</section>
